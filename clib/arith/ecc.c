#include <stdio.h>
#include <stdint.h>

#include "ecc.h"

static int ecctable_64[] = {
  0xC2 ^ 0x0c,
  0xC7 ^ 0x0c,
  0xDF ^ 0x0c,
  0xD9 ^ 0x0c,
  0xDA ^ 0x0c,
  0xD5 ^ 0x0c,
  0xD6 ^ 0x0c,
  0xD0 ^ 0x0c,
  0x2F ^ 0x0c,
  0x29 ^ 0x0c,
  0x2A ^ 0x0c,
  0x25 ^ 0x0c,
  0x26 ^ 0x0c,
  0x20 ^ 0x0c,
  0x3D ^ 0x0c,
  0x38 ^ 0x0c,
  0x02 ^ 0x0c,
  0x07 ^ 0x0c,
  0x1F ^ 0x0c,
  0x19 ^ 0x0c,
  0x1A ^ 0x0c,
  0x15 ^ 0x0c,
  0x16 ^ 0x0c,
  0x10 ^ 0x0c,
  0xEF ^ 0x0c,
  0xE9 ^ 0x0c,
  0xEA ^ 0x0c,
  0xE5 ^ 0x0c,
  0xE6 ^ 0x0c,
  0xE0 ^ 0x0c,
  0xFD ^ 0x0c,
  0xF8 ^ 0x0c,
  0x43 ^ 0x0c,
  0x46 ^ 0x0c,
  0x5E ^ 0x0c,
  0x58 ^ 0x0c,
  0x5B ^ 0x0c,
  0x54 ^ 0x0c,
  0x57 ^ 0x0c,
  0x51 ^ 0x0c,
  0xAE ^ 0x0c,
  0xA8 ^ 0x0c,
  0xAB ^ 0x0c,
  0xA4 ^ 0x0c,
  0xA7 ^ 0x0c,
  0xA1 ^ 0x0c,
  0xBC ^ 0x0c,
  0xB9 ^ 0x0c,
  0x83 ^ 0x0c,
  0x86 ^ 0x0c,
  0x9E ^ 0x0c,
  0x98 ^ 0x0c,
  0x9B ^ 0x0c,
  0x94 ^ 0x0c,
  0x97 ^ 0x0c,
  0x91 ^ 0x0c,
  0x6E ^ 0x0c,
  0x68 ^ 0x0c,
  0x6B ^ 0x0c,
  0x64 ^ 0x0c,
  0x67 ^ 0x0c,
  0x61 ^ 0x0c,
  0x7C ^ 0x0c,
  0x79 ^ 0x0c };

static int ecctable_32[] = {
  0x43 ^ 0x0c,
  0x46 ^ 0x0c,
  0x5E ^ 0x0c,
  0x58 ^ 0x0c,
  0x5B ^ 0x0c,
  0x54 ^ 0x0c,
  0x57 ^ 0x0c,
  0x51 ^ 0x0c,
  0x2F ^ 0x0c,
  0x29 ^ 0x0c,
  0x2A ^ 0x0c,
  0x25 ^ 0x0c,
  0x26 ^ 0x0c,
  0x20 ^ 0x0c,
  0x3D ^ 0x0c,
  0x38 ^ 0x0c,
  0x02 ^ 0x0c,
  0x07 ^ 0x0c,
  0x1F ^ 0x0c,
  0x19 ^ 0x0c,
  0x1A ^ 0x0c,
  0x15 ^ 0x0c,
  0x16 ^ 0x0c,
  0x10 ^ 0x0c,
  0x6E ^ 0x0c,
  0x68 ^ 0x0c,
  0x6B ^ 0x0c,
  0x64 ^ 0x0c,
  0x67 ^ 0x0c,
  0x61 ^ 0x0c,
  0x7C ^ 0x0c,
  0x79 ^ 0x0c };

int ecc_gen64(uint64_t x) {
  int c = 0x0c;
  for(int j=0; j<64; ++j, x >>= 1) 
    if (x & 1) c ^= ecctable_64[j];
  return c;
}
